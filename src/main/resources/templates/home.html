<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Main page</title>
    <link rel="stylesheet" href="/css/healthmanage.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
</head>

<body>

<div th:replace="fragments/navigationBar :: navbar"></div>

<div class="container">
    <div class="summary-box">
        <h2>Yesterday Summary</h2>
        <div class="summary-content">
            <div class="summary-text">
                <p>Exercise Burned: <span th:text="${burned}">0</span>kcal</p>
                <p>Food Intake: <span th:text="${intake}">0</span>kcal</p>
                <p>BMR: <span th:text="${bmr}">0</span>kcal</p>
                <p>
                    Calorie Balance:
                    <span th:text="${diff}">0</span>kcal
                    (<span th:style="${diff > 0 ? 'color:red;' : 'color:green;'}" th:text="${diff > 0 ? 'Surplus' : 'Deficit'}"></span>)
                </p>
            </div>
            <div class="summary-chart">
                <canvas id="yesterdayChart" width="250" height="250"></canvas>
            </div>
        </div>
    </div>

    <!--    圆环图chart.js脚本   -->
    <script th:inline="javascript">
        /*<![CDATA[*/
        // Controllerから渡された値をJavaScript変数に格納
        const intake = /*[[${intake}]]*/ 0;
        const exerciseBurned = /*[[${burned}]]*/ 0;
        const bmr = /*[[${bmr}]]*/ 0;
        // console.log("Chart Data:", intake, exerciseBurned, bmr);

        const ctx = document.getElementById('yesterdayChart').getContext('2d');
        new Chart(ctx, {
            type: "doughnut",
            data: {
                labels: ['Intake', 'Burned', 'BMR'],
                datasets: [{
                    label: 'Calories(kcal)',
                    data: [intake, exerciseBurned, bmr],
                    backgroundColor: [
                        '#e74c3c', // Intake 红
                        '#2ecc71', // Exercise 绿
                        '#3498db'  // BMR 蓝
                    ]
                }]
            },

            // options: {
            //     title: {
            //         display: true,
            //         text: "World Wide Wine Production"
            //     }
            // }
        });
    </script>



    <div class="summary-box">
        <h2>Past 7 Days</h2>
        <div class="summary-chart">
            <canvas id="past7DayChart" width="250" height="250"></canvas>
        </div>
    </div>
    <script th:inline="javascript">
        const intakeData = /*[[${intakeData}]]*/ [];
        // const dateLabels = /*[[${dateLabels}]]*/ [];
        // const burnedData = /*[[${burnedData}]]*/ [];

        const ctx = document.getElementById("past7DayChart").getContext("2d");
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Intake', 'Burned', 'Diff'],
                datasets: [{
                    label: 'Calories(kcal)',
                    data: [intakeData],
                    fill: false,
                    borderColor: ['#e74c3c']    // Intake 红
                }]
            }
        })
    </script>

    <div class="summary-box">
        <h2>Recent Records</h2>
<!--        <p>插入最近5条运动/饮食记录</p>-->
    </div>
    <div class="summary-box">
        <h2>Quick Access</h2>
<!--        <p>新建运动记录、新建饮食记录的入口链接</p>-->
    </div>
</div>

</body>



</html>